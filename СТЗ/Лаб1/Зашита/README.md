Измененный код с учетом задания для защиты
